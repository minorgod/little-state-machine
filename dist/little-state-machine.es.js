import*as e from"react";var t="action",n=function(){var e={name:"__LSM__",middleWares:[],persist:t},n={};try{e.storageType="undefined"!=typeof sessionStorage?window.sessionStorage:void 0}catch(e){}return{updateStore:function(t){try{n=e.storageType&&JSON.parse(e.storageType.getItem(e.name)||"")||t}catch(e){n=t}},saveStore:function(){e.storageType&&e.storageType.setItem(e.name,JSON.stringify(n))},get state(){return n},set state(e){n=e},get options(){return e},set options(t){e=t}}}(),o=e.createContext(void 0),r=function(t){var r=t.children,s=e.useState(n.state),a=s[0],i=s[1];return e.useEffect(function(){"beforeUnload"===n.options.persist&&(window.onbeforeunload=function(){return n.saveStore()},n.options.storageType&&n.options.storageType.removeItem(n.options.name))},[]),e.createElement(o.Provider,{value:{state:a,setState:i}},r)},s=function(){return e.useContext(o)};function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a.apply(this,arguments)}function i(e,t){t&&(n.options=a({},n.options,t)),"production"!==process.env.NODE_ENV&&"undefined"!=typeof window&&(window.__LSM_NAME__=n.options.name,window.__LSM_RESET__=function(){return n.options.storageType&&n.options.storageType.removeItem(n.options.name)}),n.updateStore(e)}function u(o){var r=s(),a=r.state,i=r.setState,u=e.useRef(Object.entries(o||{}).reduce(function(e,o){var r;return Object.assign({},e,((r={})[o[0]]=function(e,o){return function(r,s){"production"!==process.env.NODE_ENV&&(window.__LSM_NAME__=o.name),n.state=o(n.state,r),n.options.middleWares&&(n.state=n.options.middleWares.reduce(function(e,t){return t(e,o.name,r)||e},n.state)),(!s||!s.skipRender)&&e(n.state),n.options.persist===t&&n.saveStore()}}(i,o[1]),r))},{}));return{actions:u.current,state:a,getState:e.useCallback(function(){return n.state},[])}}export{r as StateMachineProvider,i as createStore,u as useStateMachine,s as useStateMachineContext};
//# sourceMappingURL=little-state-machine.es.js.map
